<script>
	/** @type {Array<() => Promise<typeof import('*.svelte')>>} */
	export let files;
	export let when = true;

	/** @type {Promise<typeof import('*.svelte')>[] | undefined} */
	let promises;
	$: if (when && !promises && files.length) {
		promises = files.map((file) => file());
	}
</script>

{#if when && promises && promises.length}
	{#await Promise.all(promises) then components}
		<slot loaded={components.map((c) => c.default)} />
	{/await}
{/if}
